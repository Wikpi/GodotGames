[gd_scene load_steps=35 format=2]

[ext_resource path="res://world/Currency.gd" type="Script" id=1]
[ext_resource path="res://world/Enemies.gd" type="Script" id=2]
[ext_resource path="res://enemy/daBOSS.tscn" type="PackedScene" id=3]
[ext_resource path="res://world/assets/floor/roof.png" type="Texture" id=4]
[ext_resource path="res://world/assets/wall/night sky.png" type="Texture" id=5]
[ext_resource path="res://world/assets/wall/ui_wall.png" type="Texture" id=6]
[ext_resource path="res://world/assets/tables/TableSideways.tscn" type="PackedScene" id=7]
[ext_resource path="res://world/assets/tables/Table.tscn" type="PackedScene" id=8]
[ext_resource path="res://world/assets/floor/hatch.png" type="Texture" id=9]
[ext_resource path="res://world/assets/rocket/full_rocket.png" type="Texture" id=10]
[ext_resource path="res://UIs/HealthUI.tscn" type="PackedScene" id=11]
[ext_resource path="res://player/Player.tscn" type="PackedScene" id=12]
[ext_resource path="res://enemy/Soldier.tscn" type="PackedScene" id=13]
[ext_resource path="res://world/assets/wall/boss_info.png" type="Texture" id=14]
[ext_resource path="res://world/Button.gd" type="Script" id=15]
[ext_resource path="res://world/Boss talk.gd" type="Script" id=16]
[ext_resource path="res://world/BOSSFLOOR.gd" type="Script" id=17]
[ext_resource path="res://world/assets/doors/Door_next_floor.tscn" type="PackedScene" id=18]
[ext_resource path="res://world/assets/Currency/Gold_coin.tscn" type="PackedScene" id=19]
[ext_resource path="res://world/WinScreen.tscn" type="PackedScene" id=20]

[sub_resource type="RectangleShape2D" id=1]
extents = Vector2( 947.803, 10 )

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 10.5321, 389.616 )

[sub_resource type="RectangleShape2D" id=3]
extents = Vector2( 12.2492, 424.166 )

[sub_resource type="RectangleShape2D" id=4]
extents = Vector2( 735.629, 10 )

[sub_resource type="GDScript" id=5]
script/source = "extends Area2D

onready var reminder = preload(\"res://player/Mission_reminder.tscn\")
var reminder_message = null

export (PackedScene) var target_scene
var no_enemies = false
var on_door = false

func _input(event):
	if on_door == true:
		if get_parent().name == \"BossFloor\":
			$Label.text = \"Jump?\"
		
		if event.is_action_pressed(\"next_floor\"):
			if get_overlapping_bodies().size() > 0:
				reminder_message = null
				if no_enemies == true:
					next_level()
				else:
					reminder_message = reminder.instance()
					get_node(\"..\").call_deferred(\"add_child\", reminder_message)
					reminder_message.global_position = get_node(\"../Player\").global_position
					reminder_message.position.x -= 65
					reminder_message.position.y -= 130
					get_node(\"CollisionShape2D\").disabled = true
					$Timer.start(4)
				
			
func next_level():
	var _ERR = get_tree().change_scene_to(target_scene)


func _on_Timer_timeout():
	reminder_message.queue_free()
	get_node(\"CollisionShape2D\").disabled = false
	$Timer.stop()

func _on_Door_next_floor_body_entered(body):
	if body.name == \"Player\":
		on_door = true


func _on_Door_next_floor_body_exited(body):
	on_door = false
"

[sub_resource type="RectangleShape2D" id=6]
extents = Vector2( 29.8832, 17.6476 )

[sub_resource type="DynamicFontData" id=7]
font_path = "res://UIs/Clickuper.ttf"

[sub_resource type="DynamicFont" id=8]
size = 36
outline_size = 2
outline_color = Color( 0.568627, 0.568627, 0.568627, 1 )
use_filter = true
font_data = SubResource( 7 )

[sub_resource type="DynamicFontData" id=9]
font_path = "res://UIs/ProzaLibre-Regular.ttf"

[sub_resource type="DynamicFont" id=10]
size = 26
font_data = SubResource( 9 )

[sub_resource type="DynamicFontData" id=11]
font_path = "res://UIs/ProzaLibre-Regular.ttf"

[sub_resource type="DynamicFont" id=12]
size = 26
font_data = SubResource( 11 )

[sub_resource type="DynamicFontData" id=13]
font_path = "res://UIs/Clickuper.ttf"

[sub_resource type="DynamicFont" id=14]
size = 28
font_data = SubResource( 13 )

[node name="BossFloor" type="Node2D"]
script = ExtResource( 17 )

[node name="YSort" type="YSort" parent="."]
position = Vector2( 6.34045, 50.2103 )

[node name="floor" type="StaticBody2D" parent="YSort"]

[node name="Sprite" type="Sprite" parent="YSort/floor"]
position = Vector2( 681.769, 370.984 )
scale = Vector2( 2.65124, 2.29483 )
texture = ExtResource( 4 )
region_enabled = true
region_rect = Rect2( -152.556, -61.8083, 527.187, 306.015 )

[node name="hatch" type="Sprite" parent="YSort/floor"]
position = Vector2( 55.5619, 186.89 )
scale = Vector2( 3.13969, 3.13969 )
texture = ExtResource( 9 )

[node name="wall" type="StaticBody2D" parent="YSort"]

[node name="Sprite2" type="Sprite" parent="YSort/wall"]
position = Vector2( 695.958, 50.7651 )
scale = Vector2( 1.02163, 0.876387 )
texture = ExtResource( 5 )

[node name="upper" type="CollisionShape2D" parent="YSort/wall"]
visible = false
position = Vector2( 515.686, 133.954 )
shape = SubResource( 1 )

[node name="right" type="CollisionShape2D" parent="YSort/wall"]
visible = false
position = Vector2( 1379.07, 334.192 )
shape = SubResource( 2 )

[node name="left" type="CollisionShape2D" parent="YSort/wall"]
visible = false
position = Vector2( -13.3435, 334.55 )
shape = SubResource( 3 )

[node name="down" type="CollisionShape2D" parent="YSort/wall"]
visible = false
position = Vector2( 662.549, 725.295 )
shape = SubResource( 4 )

[node name="UIwall" type="Sprite" parent="YSort/wall"]
position = Vector2( 685.021, -29.1571 )
scale = Vector2( 1.33713, 1 )
texture = ExtResource( 6 )

[node name="Tables" type="YSort" parent="YSort"]

[node name="Table4" parent="YSort/Tables" instance=ExtResource( 8 )]
position = Vector2( 195.186, 165.788 )

[node name="Table" parent="YSort/Tables" instance=ExtResource( 8 )]
position = Vector2( 819.926, 172.787 )

[node name="Table2" parent="YSort/Tables" instance=ExtResource( 8 )]
position = Vector2( 817.123, 442.685 )

[node name="TableSideways3" parent="YSort/Tables" instance=ExtResource( 7 )]
position = Vector2( 467.486, 160.175 )

[node name="Table3" parent="YSort/Tables" instance=ExtResource( 8 )]
position = Vector2( 191.672, 432.625 )

[node name="TableSideways" parent="YSort/Tables" instance=ExtResource( 7 )]
position = Vector2( 460.071, 456.75 )

[node name="TrashCans" type="YSort" parent="YSort"]

[node name="Plants" type="YSort" parent="YSort"]

[node name="Currency" type="YSort" parent="YSort"]

[node name="YSort" type="YSort" parent="YSort"]

[node name="Rocket" type="StaticBody2D" parent="YSort/YSort"]

[node name="Sprite" type="Sprite" parent="YSort/YSort/Rocket"]
position = Vector2( 1177.34, 202.705 )
scale = Vector2( 5.05456, 5.05456 )
texture = ExtResource( 10 )

[node name="CollisionShape2D" type="CollisionPolygon2D" parent="YSort/YSort/Rocket"]
visible = false
position = Vector2( 1194.07, 385.131 )
polygon = PoolVector2Array( -164.282, 64.4412, -104.349, -1.48434, -96.8578, -83.8912, -101.353, -140.827, -81.8748, -158.807, -83.373, -260.691, -69.8883, -268.183, -72.8849, -248.705, -62.3967, -242.712, -47.4137, -283.166, -0.966187, -326.617, 72.4509, -284.664, 76.9458, -227.729, 72.4509, -148.318, 49.9763, -70.4065, 73.9492, -26.9556, 100.919, -10.4742, 139.875, 17.9936, 153.359, 52.4547, 171.339, 67.4378, 24.505, 65.9395, -99.8545, 67.4378 )

[node name="Enemies" type="YSort" parent="YSort"]
script = ExtResource( 2 )

[node name="daBOSS" parent="YSort/Enemies" instance=ExtResource( 3 )]
position = Vector2( 663.813, 322.592 )

[node name="Soldier" parent="YSort/Enemies" instance=ExtResource( 13 )]
position = Vector2( 74.7642, 575.889 )

[node name="Soldier2" parent="YSort/Enemies" instance=ExtResource( 13 )]
position = Vector2( 943.288, 111.093 )

[node name="Player" parent="YSort" instance=ExtResource( 12 )]
position = Vector2( 40.8287, 188.349 )

[node name="Door_next_floor" parent="YSort" instance=ExtResource( 18 )]
position = Vector2( 684.101, 20.4999 )
script = SubResource( 5 )
target_scene = ExtResource( 20 )

[node name="Sprite" parent="YSort/Door_next_floor" index="0"]
texture = null

[node name="CollisionShape2D" parent="YSort/Door_next_floor" index="1"]
position = Vector2( -18.1514, 33.9206 )
shape = SubResource( 6 )

[node name="UIs" type="CanvasLayer" parent="."]

[node name="HealthUI" parent="UIs" instance=ExtResource( 11 )]
margin_left = 6.62853
margin_top = 1.28089
margin_right = 46.6286
margin_bottom = 41.2809

[node name="Currency" type="Control" parent="UIs"]
margin_left = 102.897
margin_top = -13.0353
margin_right = 142.897
margin_bottom = 26.9647
script = ExtResource( 1 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Gold_coin" parent="UIs/Currency" instance=ExtResource( 19 )]
position = Vector2( 629.021, 35.7365 )

[node name="currency_count" type="Label" parent="UIs/Currency"]
margin_left = 570.644
margin_top = 12.4443
margin_right = 616.644
margin_bottom = 65.4443
custom_fonts/font = SubResource( 8 )
align = 1
valign = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Boss talk" type="Node2D" parent="."]
pause_mode = 2
position = Vector2( -1.5874, 53.0874 )
script = ExtResource( 16 )

[node name="Sprite" type="Sprite" parent="Boss talk"]
position = Vector2( 683.029, 620.766 )
texture = ExtResource( 14 )

[node name="Label3" type="Label" parent="Boss talk"]
margin_left = 35.5484
margin_top = 667.689
margin_right = 146.548
margin_bottom = 704.689
custom_fonts/font = SubResource( 10 )
text = "The Boss"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Label" type="Label" parent="Boss talk"]
margin_left = 230.77
margin_top = 545.429
margin_right = 270.77
margin_bottom = 582.429
custom_fonts/font = SubResource( 12 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Next" type="Button" parent="Boss talk"]
margin_left = 1182.66
margin_top = 643.855
margin_right = 1323.66
margin_bottom = 691.855
custom_fonts/font = SubResource( 14 )
text = "Next"
script = ExtResource( 15 )
__meta__ = {
"_edit_use_anchors_": false
}
reference_path = "res://world/World.tscn"

[node name="next_char" type="Timer" parent="Boss talk"]

[connection signal="timeout" from="Boss talk/next_char" to="Boss talk" method="_on_next_char_timeout"]

[editable path="YSort/Door_next_floor"]
